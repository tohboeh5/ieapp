# REST API Requirements

category: REST API
prefix: REQ-API

requirements:
  - id: REQ-API-001
    title: Workspace CRUD
    description: |
      Create, retrieve, and list workspaces.
    related_spec:
      - api/rest.md#workspaces
    priority: high
    status: implemented
    tests:
      pytest:
        - file: backend/tests/test_api.py
          tests:
            - test_create_workspace
            - test_list_workspaces
            - test_get_workspace
            - test_get_workspace_not_found
      vitest:
        - file: frontend/src/lib/client.test.ts
          tests:
            - workspaceApi.list
            - workspaceApi.create
      e2e:
        - file: e2e/smoke.test.ts
          tests:
            - GET /workspaces returns list
            - GET /workspaces includes default workspace

  - id: REQ-API-002
    title: Note CRUD
    description: |
      Create, retrieve, update, and delete notes.
    related_spec:
      - api/rest.md#notes
    priority: high
    status: implemented
    tests:
      pytest:
        - file: backend/tests/test_api.py
          tests:
            - test_create_note
            - test_list_notes
            - test_get_note
            - test_update_note
            - test_delete_note
      vitest:
        - file: frontend/src/lib/client.test.ts
          tests:
            - noteApi.list
            - noteApi.create
            - noteApi.get
            - noteApi.update
            - noteApi.delete
      e2e:
        - file: e2e/notes.test.ts
          tests:
            - POST /workspaces/default/notes creates a new note
            - GET /workspaces/default/notes returns note list
            - PUT /workspaces/default/notes/:id updates note
            - DELETE /workspaces/default/notes/:id removes note

  - id: REQ-API-004
    title: Feature Registry Consistency
    description: |
      API feature registry entries MUST match implemented backend and frontend
      paths, files, and functions.
    related_spec:
      - features/README.md
      - features/features.yaml
    priority: high
    status: implemented
    tests:
      pytest:
        - file: docs/tests/test_features.py
          tests:
            - test_feature_paths_exist
            - test_no_undeclared_feature_modules

  - id: REQ-API-005
    title: Requirements Traceability Automation
    description: |
      Requirements MUST be defined in YAML and validated against test references
      in backend, frontend, ieapp-cli, and ieapp-core.
    related_spec:
      - requirements/README.md
      - testing/strategy.md
    priority: high
    status: implemented
    tests:
      pytest:
        - file: docs/tests/test_requirements.py
          tests:
            - test_requirement_ids_are_unique
            - test_required_fields_present
            - test_all_requirements_have_tests
            - test_all_tests_reference_valid_requirements
            - test_no_orphan_tests

  - id: REQ-API-006
    title: Saved SQL CRUD
    description: |
      The API MUST expose CRUD operations for saved SQL entries, including
      validation of SQL variable objects.
    related_spec:
      - api/rest.md#sql-saved-queries
      - features/sql.md#saved-sql-class
    priority: high
    status: implemented
    tests:
      pytest:
        - file: backend/tests/test_sql.py
          tests:
            - test_sql_req_api_006_crud

  - id: REQ-API-007
    title: Saved SQL variable embedding and SQL validity
    description: |
      Saved SQL entries MUST embed each declared variable in the SQL text using
      {{variable_name}} placeholders, and the SQL must be valid IEapp SQL after
      substituting placeholders with literal values.
    related_spec:
      - api/rest.md#sql-saved-queries
      - features/sql.md#saved-sql-class
    priority: high
    status: implemented
    tests:
      pytest:
        - file: backend/tests/test_sql.py
          tests:
            - test_sql_req_api_007_validation
