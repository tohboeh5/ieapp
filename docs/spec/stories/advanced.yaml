# Advanced User Stories
#
# Power user and experimental features.
# These extend the core functionality for specialized use cases.

version: "0.1"
updated: "2026-01"
category: Advanced User Stories

stories:
  - id: STORY-006
    title: Voice-to-Schema
    type: BYOAI
    as_a: mobile user
    i_want: to record a voice memo and have my chosen AI assistant structure it
    so_that: >
      I can use the best AI model available (Claude, GPT-4, etc.)
      without being locked into the app's built-in model.
    acceptance_criteria:
      - User records audio; app saves it as a note attachment
      - User invokes their connected MCP Agent (e.g., "Format this voice note")
      - Agent reads the transcript (via MCP), extracts fields, and updates the note with H2 headers
    related_apis:
      - rest: POST /workspaces/{ws_id}/attachments
      - rest: PUT /workspaces/{ws_id}/notes/{note_id}
      - mcp: ieapp://{workspace_id}/notes/{note_id}
      - mcp: run_script
    requirements:
      - REQ-NOTE-008
      - REQ-SANDBOX-001

  - id: STORY-007
    title: Computational Notebooks
    type: Live Code
    as_a: data-driven user
    i_want: to embed JavaScript code blocks in my notes that execute and render results
    so_that: I can create live reports or analyze my own knowledge base within the app.
    acceptance_criteria:
      - Markdown code blocks tagged `javascript` can be executed
      - Code runs in the same Wasm sandbox as the MCP agent
      - Output (text, tables, charts) is rendered interactively below the code block
    related_apis:
      - rest: POST /workspaces/{ws_id}/notes/{note_id}/blocks/{block_id}/execute
      - mcp: run_script
    requirements:
      - REQ-SANDBOX-001
      - REQ-SANDBOX-002

  - id: STORY-008
    title: Agentic Refactoring
    type: BYOAI
    as_a: user with a messy workspace
    i_want: to ask my AI agent to "clean up this folder"
    so_that: I can leverage external intelligence to organize my knowledge base on demand.
    acceptance_criteria:
      - App exposes `run_script` tool via MCP
      - User asks Agent: "Find duplicates in Project X and merge them."
      - Agent executes the logic and presents the result for confirmation
    related_apis:
      - mcp: run_script
      - rest: GET/PUT /workspaces/{ws_id}/notes/{note_id}
    requirements:
      - REQ-SANDBOX-001
      - REQ-SANDBOX-002

  - id: STORY-009
    title: Data Grid
    type: Class
    as_a: power user
    i_want: to view and edit my class data in a spreadsheet-like grid
    so_that: I can bulk edit, copy-paste to/from Excel, and manage data efficiently.
    acceptance_criteria:
      - Class Detail view presents a data grid
      - Drag Select: Users can drag to select multiple cells (rectangular selection) and copy
      - Inline Edit: Users can toggle Edit Mode and edit cells in place
      - Quick Add: Users can add a new row (Note) directly from the grid view
      - Changes are saved immediately or on blur
    related_apis:
      - rest: PUT /workspaces/{ws_id}/notes/{note_id}
      - rest: POST /workspaces/{ws_id}/notes
    requirements:
      - REQ-FE-030
      - REQ-FE-031
