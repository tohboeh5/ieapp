<!DOCTYPE html><html lang="en"> <head><meta charset="utf-8"><meta name="viewport" content="width=device-width"><title>Docs: tests/README.md</title><link rel="stylesheet" href="/_astro/_slug_.DCtb3bYL.css"></head> <body> <header class="mx-auto flex max-w-6xl flex-wrap items-center justify-between gap-3 px-4 py-4"> <a href="/" class="text-lg font-semibold">Ugoite Docsite</a> <nav class="flex items-center gap-4 text-sm"> <a href="/docs/guide/cli" class="underline-offset-2 hover:underline">CLI Guide</a> <a href="/docs/spec/api/rest" class="underline-offset-2 hover:underline">REST API</a> <a href="/docs/spec/api/mcp" class="underline-offset-2 hover:underline">MCP API</a> </nav> <div class="flex items-center gap-3"> <label for="theme" class="text-sm text-slate-600">Theme</label> <select id="theme" class="rounded-md border px-2 py-1 text-sm" data-theme-selector> <option value="materialize">Materialize</option><option value="classic">Classic</option><option value="pop">Pop</option> </select> <label for="mode" class="text-sm text-slate-600">Mode</label> <select id="mode" class="rounded-md border px-2 py-1 text-sm" data-mode-selector> <option value="light">Light</option> <option value="dark">Dark</option> </select> </div> <script type="module">const o="ugoite-ui-theme",l="ugoite-color-mode",m=document.documentElement,e=document.querySelector("[data-theme-selector]"),t=document.querySelector("[data-mode-selector]"),a=()=>{const c=e instanceof HTMLSelectElement?e.value:localStorage.getItem(o)||"materialize",n=t instanceof HTMLSelectElement?t.value:localStorage.getItem(l)||"light";m.dataset.uiTheme=c,m.dataset.colorMode=n,localStorage.setItem(o,c),localStorage.setItem(l,n)},i=localStorage.getItem(o)||"materialize",s=localStorage.getItem(l)||"light";e instanceof HTMLSelectElement&&(e.value=i,e.addEventListener("change",()=>{a()}));t instanceof HTMLSelectElement&&(t.value=s,t.addEventListener("change",()=>{a()}));a();</script> </header> <main class="mx-auto max-w-6xl px-4 pb-16">  <article class="prose max-w-none rounded-xl border p-6" style="background: var(--doc-card); border-color: var(--doc-border);"> <p class="mb-4 text-xs" style="color: var(--doc-muted);">Source: /docs/tests/README.md</p> <h1>Documentation Consistency Tests</h1>
<p>This directory contains tests that verify documentation consistency and requirements traceability.</p>
<h2>Purpose</h2>
<p>These tests ensure:</p>
<ol>
<li><strong>Requirements Coverage</strong>: Every requirement has at least one test</li>
<li><strong>Test Traceability</strong>: Tests reference valid requirements</li>
<li><strong>Feature Registry Consistency</strong>: API registries match code (<code>docs/spec/features/features.yaml</code> + per-kind YAML files)</li>
<li><strong>Documentation Cross-References</strong>: Links between documents are valid</li>
<li><strong>Story Format Validation</strong>: User stories follow the required YAML format</li>
</ol>
<h2>Test Files (To Be Implemented)</h2>
<table>
<thead>
<tr>
<th>File</th>
<th>Purpose</th>
</tr>
</thead>
<tbody><tr>
<td><code>test_requirements.py</code></td>
<td>Verify requirement â†’ test mapping</td>
</tr>
<tr>
<td><code>test_features.py</code></td>
<td>Verify feature paths exist in codebase</td>
</tr>
<tr>
<td><code>test_stories.py</code></td>
<td>Validate story YAML format</td>
</tr>
<tr>
<td><code>test_docs_links.py</code></td>
<td>Check cross-references between docs</td>
</tr>
</tbody></table>
<h2>Running Tests</h2>
<pre><code class="language-bash"># From repository root
cd docs/tests
python -m pytest

# Or with verbose output
python -m pytest -v
</code></pre>
<h2>Test Details</h2>
<h3>Requirement-aware Naming Convention</h3>
<p>Requirement traceability is enforced by:</p>
<ol>
<li>Listing test names in <code>docs/spec/requirements/*.yaml</code></li>
<li>Including <code>REQ-*</code> IDs in test docstrings or comments</li>
</ol>
<p>Python tests currently use descriptive names, with requirement IDs in docstrings:</p>
<pre><code class="language-python">def test_all_requirements_have_tests() -&gt; None:
    &quot;&quot;&quot;REQ-API-005: Requirements must list tests and files must exist.&quot;&quot;&quot;
    ...
</code></pre>
<p>Rust tests in <code>ugoite-core/tests/</code> follow a requirement-aware naming pattern:</p>
<pre><code class="language-rust">async fn test_entry_req_entry_001_create_entry_basic() -&gt; anyhow::Result&lt;()&gt; {
    // REQ-ENTRY-001
    ...
}
</code></pre>
<p>When adopting this pattern, replace hyphens in <code>REQ-XXX-001</code> with underscores to
form <code>req_xxx_001</code>, and keep <code>feature</code> aligned to the domain under test (e.g.
api, space, entry, form, core, cli).</p>
<h3>test_requirements.py</h3>
<pre><code class="language-python">def test_all_requirements_have_tests():
    &quot;&quot;&quot;
    Load all YAML files from docs/spec/requirements/
    Verify each requirement has at least one test in its tests array
    &quot;&quot;&quot;
    pass

def test_all_tests_reference_valid_requirements():
    &quot;&quot;&quot;
    Scan test files for REQ-* mentions
    Verify each reference exists in requirements YAML
    &quot;&quot;&quot;
    pass

def test_no_orphan_tests():
    &quot;&quot;&quot;
    Find tests not listed in any requirement&#39;s tests array
    Report as warnings (not failures)
    &quot;&quot;&quot;
    pass

def test_requirement_ids_are_unique():
    &quot;&quot;&quot;
    Ensure no duplicate requirement IDs across all files
    &quot;&quot;&quot;
    pass
</code></pre>
<h3>test_features.py</h3>
<pre><code class="language-python">def test_feature_paths_exist():
    &quot;&quot;&quot;
    Load docs/spec/features/features.yaml (manifest)
    Load each referenced per-kind registry YAML
    Verify each (file, function/component) reference exists in the codebase
    &quot;&quot;&quot;
    pass

def test_no_undeclared_feature_modules():
    &quot;&quot;&quot;
    Find API operations in code that are not declared in the registry
    Report as warnings
    &quot;&quot;&quot;
    pass
</code></pre>
<h3>test_stories.py</h3>
<pre><code class="language-python">def test_story_format_valid():
    &quot;&quot;&quot;
    Validate YAML structure of all story files
    Required fields: id, title, as_a, i_want, so_that, acceptance_criteria
    &quot;&quot;&quot;
    pass

def test_story_requirements_exist():
    &quot;&quot;&quot;
    Verify all REQ-* references in stories exist
    &quot;&quot;&quot;
    pass
</code></pre>
<h3>test_docs_links.py</h3>
<pre><code class="language-python">def test_markdown_links_valid():
    &quot;&quot;&quot;
    Parse all .md files for relative links
    Verify targets exist
    &quot;&quot;&quot;
    pass

def test_yaml_spec_references_valid():
    &quot;&quot;&quot;
    Parse related_spec fields in YAML files
    Verify referenced files and sections exist
    &quot;&quot;&quot;
    pass
</code></pre>
<h2>Adding New Tests</h2>
<ol>
<li>Create test file following <code>test_*.py</code> naming</li>
<li>Use <code>pytest</code> conventions</li>
<li>Load YAML files using <code>pyyaml</code></li>
<li>Use <code>pathlib</code> for cross-platform path handling</li>
<li>Document test purpose in docstrings</li>
</ol>
<h3>Requirement-aware Naming</h3>
<p>For pytest tests that validate a specific requirement, use:</p>
<pre><code class="language-python"># Pattern: test_&lt;feature&gt;_&lt;requirement_id&gt;_&lt;description&gt;
# Example (REQ-API-005):
def test_docs_req_api_005_all_requirements_have_tests():
    &quot;&quot;&quot;REQ-API-005: Requirements Traceability Automation&quot;&quot;&quot;
    ...
</code></pre>
<p>Details:</p>
<ul>
<li>Replace hyphens in <code>REQ-XXX-001</code> with underscores to form <code>req_xxx_001</code>.</li>
<li><code>feature</code> should reflect the domain under test (e.g., docs, api, entry).</li>
</ul>
<h2>Dependencies</h2>
<pre><code class="language-txt"># requirements.txt for docs/tests
pytest&gt;=7.0
pyyaml&gt;=6.0
</code></pre>
<h2>CI Integration</h2>
<p>These tests should run as part of CI:</p>
<pre><code class="language-yaml"># .github/workflows/docs-ci.yml
jobs:
  docs-tests:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - uses: actions/setup-python@v5
        with:
          python-version: &#39;3.12&#39;
      - run: pip install pytest pyyaml
      - run: cd docs/tests &amp;&amp; pytest -v
</code></pre>
<h2>Coverage Report</h2>
<p>Generate a coverage report with:</p>
<pre><code class="language-bash">python generate_coverage_report.py
</code></pre>
<p>This produces:</p>
<ul>
<li>Total requirements by category</li>
<li>Implemented vs planned requirements  </li>
<li>Test coverage percentage</li>
<li>Orphan tests list</li>
<li>Missing documentation cross-references</li>
</ul>
 </article>  </main> </body></html>