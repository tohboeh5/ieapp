<!DOCTYPE html><html lang="en"> <head><meta charset="utf-8"><meta name="viewport" content="width=device-width"><title>Docs: spec/api/rest.md</title><link rel="stylesheet" href="/_astro/_slug_.DCtb3bYL.css"></head> <body> <header class="mx-auto flex max-w-6xl flex-wrap items-center justify-between gap-3 px-4 py-4"> <a href="/" class="text-lg font-semibold">Ugoite Docsite</a> <nav class="flex items-center gap-4 text-sm"> <a href="/docs/guide/cli" class="underline-offset-2 hover:underline">CLI Guide</a> <a href="/docs/spec/api/rest" class="underline-offset-2 hover:underline">REST API</a> <a href="/docs/spec/api/mcp" class="underline-offset-2 hover:underline">MCP API</a> </nav> <div class="flex items-center gap-3"> <label for="theme" class="text-sm text-slate-600">Theme</label> <select id="theme" class="rounded-md border px-2 py-1 text-sm" data-theme-selector> <option value="materialize">Materialize</option><option value="classic">Classic</option><option value="pop">Pop</option> </select> <label for="mode" class="text-sm text-slate-600">Mode</label> <select id="mode" class="rounded-md border px-2 py-1 text-sm" data-mode-selector> <option value="light">Light</option> <option value="dark">Dark</option> </select> </div> <script type="module">const o="ugoite-ui-theme",l="ugoite-color-mode",m=document.documentElement,e=document.querySelector("[data-theme-selector]"),t=document.querySelector("[data-mode-selector]"),a=()=>{const c=e instanceof HTMLSelectElement?e.value:localStorage.getItem(o)||"materialize",n=t instanceof HTMLSelectElement?t.value:localStorage.getItem(l)||"light";m.dataset.uiTheme=c,m.dataset.colorMode=n,localStorage.setItem(o,c),localStorage.setItem(l,n)},i=localStorage.getItem(o)||"materialize",s=localStorage.getItem(l)||"light";e instanceof HTMLSelectElement&&(e.value=i,e.addEventListener("change",()=>{a()}));t instanceof HTMLSelectElement&&(t.value=s,t.addEventListener("change",()=>{a()}));a();</script> </header> <main class="mx-auto max-w-6xl px-4 pb-16">  <article class="prose max-w-none rounded-xl border p-6" style="background: var(--doc-card); border-color: var(--doc-border);"> <p class="mb-4 text-xs" style="color: var(--doc-muted);">Source: /docs/spec/api/rest.md</p> <h1>REST API Specification</h1>
<h2>Overview</h2>
<p>The REST API is the primary interface for the frontend and external integrations.</p>
<p><strong>Base URL</strong>: <code>http://localhost:8000</code> (development)</p>
<h2>Authentication</h2>
<p>By default, the API binds to localhost only and requires no authentication.
When <code>UGOITE_ALLOW_REMOTE=true</code>, authentication is required (future milestone).</p>
<h2>Endpoints</h2>
<h3>Spaces</h3>
<h4>List Spaces</h4>
<pre><code class="language-http">GET /spaces
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json">[
  {
    &quot;id&quot;: &quot;ws-main&quot;,
    &quot;name&quot;: &quot;Personal Knowledge&quot;,
    &quot;created_at&quot;: &quot;2025-08-12T12:00:00Z&quot;
  }
]
</code></pre>
<h4>Create Space</h4>
<pre><code class="language-http">POST /spaces
Content-Type: application/json

{
  &quot;id&quot;: &quot;space-new&quot;,
  &quot;name&quot;: &quot;New Space&quot;
}
</code></pre>
<p><strong>Response</strong>: <code>201 Created</code></p>
<h4>Get Space</h4>
<pre><code class="language-http">GET /spaces/{id}
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code></p>
<h4>Update Space</h4>
<pre><code class="language-http">PATCH /spaces/{id}
Content-Type: application/json

{
  &quot;name&quot;: &quot;Updated Name&quot;,
  &quot;storage_config&quot;: { &quot;uri&quot;: &quot;s3://bucket/path&quot; },
  &quot;settings&quot;: { &quot;default_form&quot;: &quot;Meeting&quot; }
}
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code></p>
<h4>Test Connection</h4>
<pre><code class="language-http">POST /spaces/{id}/test-connection
Content-Type: application/json

{
  &quot;uri&quot;: &quot;s3://bucket/path&quot;,
  &quot;credentials_profile&quot;: &quot;default&quot;
}
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code> or <code>400 Bad Request</code></p>
<hr>
<h3>Entries</h3>
<h4>List Entries</h4>
<pre><code class="language-http">GET /spaces/{space_id}/entries
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json">[
  {
    &quot;id&quot;: &quot;entry-uuid&quot;,
    &quot;title&quot;: &quot;Weekly Sync&quot;,
    &quot;form&quot;: &quot;Meeting&quot;,
    &quot;updated_at&quot;: &quot;2025-11-29T10:00:00Z&quot;,
    &quot;properties&quot;: { &quot;Date&quot;: &quot;2025-11-29&quot; },
    &quot;tags&quot;: [&quot;project-alpha&quot;],
    &quot;links&quot;: []
  }
]
</code></pre>
<h4>Create Entry</h4>
<pre><code class="language-http">POST /spaces/{space_id}/entries
Content-Type: application/json

{
  &quot;markdown&quot;: &quot;# My Entry\n\n## Field\nValue&quot;
}
</code></pre>
<p><strong>Response</strong>: <code>201 Created</code></p>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;entry-new-uuid&quot;,
  &quot;title&quot;: &quot;My Entry&quot;,
  &quot;revision_id&quot;: &quot;rev-0001&quot;,
  &quot;properties&quot;: { &quot;Field&quot;: &quot;Value&quot; }
}
</code></pre>
<h4>Get Entry</h4>
<pre><code class="language-http">GET /spaces/{space_id}/entries/{entry_id}
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;entry-uuid&quot;,
  &quot;markdown&quot;: &quot;# My Entry\n\n## Field\nValue&quot;,
  &quot;revision_id&quot;: &quot;rev-0001&quot;,
  &quot;properties&quot;: { &quot;Field&quot;: &quot;Value&quot; }
}
</code></pre>
<h4>Update Entry</h4>
<pre><code class="language-http">PUT /spaces/{space_id}/entries/{entry_id}
Content-Type: application/json

{
  &quot;markdown&quot;: &quot;# Updated Entry&quot;,
  &quot;parent_revision_id&quot;: &quot;rev-0001&quot;
}
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;entry-uuid&quot;,
  &quot;revision_id&quot;: &quot;rev-0002&quot;
}
</code></pre>
<p><strong>Error</strong>: <code>409 Conflict</code> if <code>parent_revision_id</code> doesn&#39;t match current</p>
<h4>Delete Entry</h4>
<pre><code class="language-http">DELETE /spaces/{space_id}/entries/{entry_id}
</code></pre>
<p><strong>Response</strong>: <code>204 No Content</code></p>
<h4>Get Entry History</h4>
<pre><code class="language-http">GET /spaces/{space_id}/entries/{entry_id}/history
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json">{
  &quot;entry_id&quot;: &quot;entry-uuid&quot;,
  &quot;revisions&quot;: [
    { &quot;revision_id&quot;: &quot;rev-0001&quot;, &quot;timestamp&quot;: &quot;2025-11-01T12:00:00Z&quot; },
    { &quot;revision_id&quot;: &quot;rev-0002&quot;, &quot;timestamp&quot;: &quot;2025-11-29T10:00:00Z&quot; }
  ]
}
</code></pre>
<h4>Get Revision</h4>
<pre><code class="language-http">GET /spaces/{space_id}/entries/{entry_id}/history/{revision_id}
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code></p>
<h4>Restore Revision</h4>
<pre><code class="language-http">POST /spaces/{space_id}/entries/{entry_id}/restore
Content-Type: application/json

{
  &quot;revision_id&quot;: &quot;rev-0001&quot;
}
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code></p>
<hr>
<h3>Forms</h3>
<h4>List Forms</h4>
<pre><code class="language-http">GET /spaces/{space_id}/forms
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json">[
  {
    &quot;name&quot;: &quot;Meeting&quot;,
    &quot;version&quot;: 1,
    &quot;fields&quot;: { &quot;Date&quot;: { &quot;type&quot;: &quot;date&quot;, &quot;required&quot;: true } }
  }
]
</code></pre>
<h4>Get Form</h4>
<pre><code class="language-http">GET /spaces/{space_id}/forms/{name}
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code></p>
<h4>Create/Update Form</h4>
<pre><code class="language-http">PUT /spaces/{space_id}/forms/{name}
Content-Type: application/json

{
  &quot;name&quot;: &quot;Meeting&quot;,
  &quot;version&quot;: 1,
  &quot;fields&quot;: {
    &quot;Date&quot;: { &quot;type&quot;: &quot;date&quot;, &quot;required&quot;: true },
    &quot;Attendees&quot;: { &quot;type&quot;: &quot;list&quot;, &quot;required&quot;: false },
    &quot;Related&quot;: { &quot;type&quot;: &quot;row_reference&quot;, &quot;required&quot;: false, &quot;target_form&quot;: &quot;Project&quot; }
  }
}
</code></pre>
<p><strong>Info</strong>: The entry template is fixed globally (<code># {form_name}</code> + H2 columns) and is not
customizable per form.</p>
<p><strong>Response</strong>: <code>200 OK</code></p>
<h4>Delete Form</h4>
<pre><code class="language-http">DELETE /spaces/{space_id}/forms/{name}
</code></pre>
<p><strong>Response</strong>: <code>204 No Content</code> or <code>409 Conflict</code> if entries still reference it</p>
<h4>List Column Types</h4>
<pre><code class="language-http">GET /spaces/{space_id}/forms/types
</code></pre>
<hr>
<h3>SQL (Saved Queries)</h3>
<h4>List SQL</h4>
<pre><code class="language-http">GET /spaces/{space_id}/sql
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json">[
  {
    &quot;id&quot;: &quot;sql-uuid&quot;,
    &quot;name&quot;: &quot;Recent Meetings&quot;,
    &quot;sql&quot;: &quot;SELECT * FROM Meeting WHERE Date &gt;= {{since}} ORDER BY updated_at DESC LIMIT 50&quot;,
    &quot;variables&quot;: [
      { &quot;type&quot;: &quot;date&quot;, &quot;name&quot;: &quot;since&quot;, &quot;description&quot;: &quot;Lower bound date&quot; }
    ],
    &quot;created_at&quot;: &quot;2026-02-01T00:00:00Z&quot;,
    &quot;updated_at&quot;: &quot;2026-02-01T00:00:00Z&quot;,
    &quot;revision_id&quot;: &quot;rev-0001&quot;
  }
]
</code></pre>
<h4>Create SQL</h4>
<pre><code class="language-http">POST /spaces/{space_id}/sql
Content-Type: application/json

{
  &quot;name&quot;: &quot;Recent Meetings&quot;,
  &quot;sql&quot;: &quot;SELECT * FROM Meeting WHERE Date &gt;= {{since}} ORDER BY updated_at DESC LIMIT 50&quot;,
  &quot;variables&quot;: [
    { &quot;type&quot;: &quot;date&quot;, &quot;name&quot;: &quot;since&quot;, &quot;description&quot;: &quot;Lower bound date&quot; }
  ]
}
</code></pre>
<p><strong>Response</strong>: <code>201 Created</code></p>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;sql-uuid&quot;,
  &quot;revision_id&quot;: &quot;rev-0001&quot;
}
</code></pre>
<h4>Get SQL</h4>
<pre><code class="language-http">GET /spaces/{space_id}/sql/{sql_id}
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;sql-uuid&quot;,
  &quot;name&quot;: &quot;Recent Meetings&quot;,
  &quot;sql&quot;: &quot;SELECT * FROM Meeting WHERE Date &gt;= {{since}} ORDER BY updated_at DESC LIMIT 50&quot;,
  &quot;variables&quot;: [
    { &quot;type&quot;: &quot;date&quot;, &quot;name&quot;: &quot;since&quot;, &quot;description&quot;: &quot;Lower bound date&quot; }
  ],
  &quot;created_at&quot;: &quot;2026-02-01T00:00:00Z&quot;,
  &quot;updated_at&quot;: &quot;2026-02-01T00:00:00Z&quot;,
  &quot;revision_id&quot;: &quot;rev-0001&quot;
}
</code></pre>
<h4>Update SQL</h4>
<pre><code class="language-http">PUT /spaces/{space_id}/sql/{sql_id}
Content-Type: application/json

{
  &quot;name&quot;: &quot;Recent Meetings&quot;,
  &quot;sql&quot;: &quot;SELECT * FROM Meeting WHERE Date &gt;= {{since}}&quot;,
  &quot;variables&quot;: [
    { &quot;type&quot;: &quot;date&quot;, &quot;name&quot;: &quot;since&quot;, &quot;description&quot;: &quot;Lower bound date&quot; }
  ],
  &quot;parent_revision_id&quot;: &quot;rev-0001&quot;
}
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;sql-uuid&quot;,
  &quot;revision_id&quot;: &quot;rev-0002&quot;
}
</code></pre>
<h4>Delete SQL</h4>
<pre><code class="language-http">DELETE /spaces/{space_id}/sql/{sql_id}
</code></pre>
<p><strong>Response</strong>: <code>204 No Content</code></p>
<hr>
<h3>Assets</h3>
<h4>Upload Asset</h4>
<pre><code class="language-http">POST /spaces/{space_id}/assets
Content-Type: multipart/form-data

file=@audio.m4a
</code></pre>
<p><strong>Response</strong>: <code>201 Created</code></p>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;a1b2c3d4&quot;,
  &quot;name&quot;: &quot;audio.m4a&quot;,
  &quot;path&quot;: &quot;assets/a1b2c3d4.m4a&quot;
}
</code></pre>
<h4>Delete Asset</h4>
<pre><code class="language-http">DELETE /spaces/{space_id}/assets/{id}
</code></pre>
<p><strong>Response</strong>: <code>204 No Content</code> or <code>409 Conflict</code> if still referenced</p>
<hr>
<h3>Query &amp; Search</h3>
<h4>Structured Query</h4>
<pre><code class="language-http">POST /spaces/{space_id}/query
Content-Type: application/json

{
  &quot;filter&quot;: {
    &quot;form&quot;: &quot;Meeting&quot;,
    &quot;properties.Date&quot;: { &quot;$gt&quot;: &quot;2025-01-01&quot; }
  }
}
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code></p>
<h4>SQL Sessions</h4>
<p>SQL queries run through session-based endpoints. Creating a session stores
<strong>metadata only</strong> under <code>sql_sessions/</code>. Result rows are never persisted; each
request re-runs the SQL against the current entries tables. The
<code>view.snapshot_id</code> is a logical marker reserved for future materialized view
support.</p>
<h5>Create SQL Session</h5>
<pre><code class="language-http">POST /spaces/{space_id}/sql-sessions
Content-Type: application/json

{
  &quot;sql&quot;: &quot;SELECT * FROM Meeting WHERE Date &gt;= &#39;2025-01-01&#39; ORDER BY updated_at DESC LIMIT 50&quot;
}
</code></pre>
<p><strong>Response</strong>: <code>201 Created</code></p>
<pre><code class="language-json">{
  &quot;id&quot;: &quot;session-uuid&quot;,
  &quot;space_id&quot;: &quot;space-uuid&quot;,
  &quot;sql_id&quot;: &quot;sql-uuid&quot;,
  &quot;sql&quot;: &quot;SELECT * FROM Meeting WHERE Date &gt;= &#39;2025-01-01&#39; ORDER BY updated_at DESC LIMIT 50&quot;,
  &quot;status&quot;: &quot;ready&quot;,
  &quot;created_at&quot;: &quot;2026-02-03T12:00:00Z&quot;,
  &quot;expires_at&quot;: &quot;2026-02-03T12:10:00Z&quot;,
  &quot;view&quot;: {
    &quot;sql_id&quot;: &quot;sql-uuid&quot;,
    &quot;snapshot_id&quot;: 42,
    &quot;snapshot_at&quot;: &quot;2026-02-03T12:00:00Z&quot;,
    &quot;schema_version&quot;: 1
  },
  &quot;pagination&quot;: {&quot;strategy&quot;: &quot;offset&quot;, &quot;order_by&quot;: [&quot;updated_at&quot;, &quot;id&quot;], &quot;default_limit&quot;: 50, &quot;max_limit&quot;: 1000},
  &quot;count&quot;: {&quot;mode&quot;: &quot;on_demand&quot;, &quot;cached_at&quot;: null, &quot;value&quot;: null},
  &quot;error&quot;: null
}
</code></pre>
<h5>Get SQL Session Status</h5>
<pre><code class="language-http">GET /spaces/{space_id}/sql-sessions/{session_id}
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code></p>
<h5>Get SQL Session Count</h5>
<pre><code class="language-http">GET /spaces/{space_id}/sql-sessions/{session_id}/count
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json">{
  &quot;count&quot;: 42
}
</code></pre>
<h5>Get SQL Session Rows (paged)</h5>
<pre><code class="language-http">GET /spaces/{space_id}/sql-sessions/{session_id}/rows?offset=0&amp;limit=50
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code></p>
<pre><code class="language-json">{
  &quot;rows&quot;: [/* entry records */],
  &quot;offset&quot;: 0,
  &quot;limit&quot;: 50,
  &quot;total_count&quot;: 42
}
</code></pre>
<h5>Stream SQL Session Rows</h5>
<pre><code class="language-http">GET /spaces/{space_id}/sql-sessions/{session_id}/stream
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code> (NDJSON stream)</p>
<h4>Keyword Search</h4>
<pre><code class="language-http">GET /spaces/{space_id}/search?q=project
</code></pre>
<p><strong>Response</strong>: <code>200 OK</code></p>
<hr>
<h2>Error Responses</h2>
<table>
<thead>
<tr>
<th>Status</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>400</code></td>
<td>Bad Request - Invalid input</td>
</tr>
<tr>
<td><code>404</code></td>
<td>Not Found - Resource doesn&#39;t exist</td>
</tr>
<tr>
<td><code>409</code></td>
<td>Conflict - Duplicate or version mismatch</td>
</tr>
<tr>
<td><code>422</code></td>
<td>Validation Error - Form violation</td>
</tr>
<tr>
<td><code>500</code></td>
<td>Internal Server Error</td>
</tr>
</tbody></table>
<p>Error response format:</p>
<pre><code class="language-json">{
  &quot;detail&quot;: &quot;Error description&quot;
}
</code></pre>
<h2>Headers</h2>
<h3>Response Headers</h3>
<table>
<thead>
<tr>
<th>Header</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td><code>X-Request-ID</code></td>
<td>Unique request identifier</td>
</tr>
<tr>
<td><code>X-Content-HMAC</code></td>
<td>HMAC signature for response body</td>
</tr>
<tr>
<td><code>Content-Type</code></td>
<td>Always <code>application/json</code></td>
</tr>
</tbody></table>
 </article>  </main> </body></html>