<!DOCTYPE html><html lang="en"> <head><meta charset="utf-8"><meta name="viewport" content="width=device-width"><title>Docs: spec/testing/strategy.md</title><link rel="stylesheet" href="/_astro/_slug_.DCtb3bYL.css"></head> <body> <header class="mx-auto flex max-w-6xl flex-wrap items-center justify-between gap-3 px-4 py-4"> <a href="/" class="text-lg font-semibold">Ugoite Docsite</a> <nav class="flex items-center gap-4 text-sm"> <a href="/docs/guide/cli" class="underline-offset-2 hover:underline">CLI Guide</a> <a href="/docs/spec/api/rest" class="underline-offset-2 hover:underline">REST API</a> <a href="/docs/spec/api/mcp" class="underline-offset-2 hover:underline">MCP API</a> </nav> <div class="flex items-center gap-3"> <label for="theme" class="text-sm text-slate-600">Theme</label> <select id="theme" class="rounded-md border px-2 py-1 text-sm" data-theme-selector> <option value="materialize">Materialize</option><option value="classic">Classic</option><option value="pop">Pop</option> </select> <label for="mode" class="text-sm text-slate-600">Mode</label> <select id="mode" class="rounded-md border px-2 py-1 text-sm" data-mode-selector> <option value="light">Light</option> <option value="dark">Dark</option> </select> </div> <script type="module">const o="ugoite-ui-theme",l="ugoite-color-mode",m=document.documentElement,e=document.querySelector("[data-theme-selector]"),t=document.querySelector("[data-mode-selector]"),a=()=>{const c=e instanceof HTMLSelectElement?e.value:localStorage.getItem(o)||"materialize",n=t instanceof HTMLSelectElement?t.value:localStorage.getItem(l)||"light";m.dataset.uiTheme=c,m.dataset.colorMode=n,localStorage.setItem(o,c),localStorage.setItem(l,n)},i=localStorage.getItem(o)||"materialize",s=localStorage.getItem(l)||"light";e instanceof HTMLSelectElement&&(e.value=i,e.addEventListener("change",()=>{a()}));t instanceof HTMLSelectElement&&(t.value=s,t.addEventListener("change",()=>{a()}));a();</script> </header> <main class="mx-auto max-w-6xl px-4 pb-16">  <article class="prose max-w-none rounded-xl border p-6" style="background: var(--doc-card); border-color: var(--doc-border);"> <p class="mb-4 text-xs" style="color: var(--doc-muted);">Source: /docs/spec/testing/strategy.md</p> <h1>Testing Strategy</h1>
<h2>Philosophy</h2>
<p>Ugoite follows <strong>Test-Driven Development (TDD)</strong>:</p>
<ol>
<li>Write failing test first</li>
<li>Implement minimal code to pass</li>
<li>Refactor while keeping tests green</li>
</ol>
<h2>Test Pyramid</h2>
<pre><code>        ╱╲
       ╱E2E╲         Few: Critical user flows
      ╱──────╲
     ╱Integr.╲       Some: API + component tests
    ╱──────────╲
   ╱   Unit     ╲    Many: Fast, isolated tests
  ╱──────────────╲
</code></pre>
<h2>Test Types</h2>
<h3>Unit Tests</h3>
<table>
<thead>
<tr>
<th>Module</th>
<th>Framework</th>
<th>Location</th>
</tr>
</thead>
<tbody><tr>
<td>ugoite-cli</td>
<td>pytest</td>
<td><code>ugoite-cli/tests/</code></td>
</tr>
<tr>
<td>backend</td>
<td>pytest</td>
<td><code>backend/tests/</code></td>
</tr>
<tr>
<td>frontend</td>
<td>vitest</td>
<td><code>frontend/src/**/*.test.ts(x)</code></td>
</tr>
</tbody></table>
<h3>Integration Tests</h3>
<ul>
<li>Backend: FastAPI TestClient with memory filesystem</li>
<li>Frontend: Component tests with mocked API</li>
</ul>
<h3>End-to-End Tests</h3>
<table>
<thead>
<tr>
<th>Framework</th>
<th>Location</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>Playwright</td>
<td><code>e2e/</code></td>
<td>TypeScript tests against live servers</td>
</tr>
</tbody></table>
<h2>Running Tests</h2>
<h3>All Tests</h3>
<pre><code class="language-bash">mise run test
</code></pre>
<h3>Individual Packages</h3>
<pre><code class="language-bash">mise run //backend:test    # Backend pytest
mise run //frontend:test   # Frontend vitest
mise run //ugoite-cli:test  # CLI pytest
</code></pre>
<h3>E2E Tests</h3>
<pre><code class="language-bash">mise run e2e
</code></pre>
<p>This command:</p>
<ol>
<li>Starts backend server on port 8000</li>
<li>Starts frontend server on port 3000</li>
<li>Waits for servers to be ready</li>
<li>Executes E2E tests</li>
<li>Shuts down servers</li>
</ol>
<h3>Fast E2E Iteration</h3>
<pre><code class="language-bash"># Terminal 1: Backend
mise run //backend:dev

# Terminal 2: Frontend
mise run //frontend:dev

# Terminal 3: Run E2E tests
cd e2e &amp;&amp; npm run test
</code></pre>
<h2>Coverage Requirements</h2>
<table>
<thead>
<tr>
<th>Module</th>
<th>Target</th>
<th>Current</th>
</tr>
</thead>
<tbody><tr>
<td>ugoite-cli</td>
<td>&gt;80%</td>
<td>~85%</td>
</tr>
<tr>
<td>backend</td>
<td>&gt;80%</td>
<td>~75%</td>
</tr>
<tr>
<td>frontend</td>
<td>&gt;70%</td>
<td>~70%</td>
</tr>
<tr>
<td>e2e</td>
<td>Critical paths</td>
<td>Complete</td>
</tr>
</tbody></table>
<h2>Test Organization</h2>
<h3>Naming Convention</h3>
<pre><code class="language-python"># Pattern: test_&lt;feature&gt;_&lt;scenario&gt;
def test_space_create_success():
    ...

def test_space_create_duplicate_returns_409():
    ...
</code></pre>
<h3>Requirement-aware Naming Convention</h3>
<p>For pytest tests that validate a specific requirement, use:</p>
<pre><code class="language-python"># Pattern: test_&lt;feature&gt;_&lt;requirement_id&gt;_&lt;description&gt;
# Example (REQ-API-001):
def test_api_req_api_001_create_space():
    &quot;&quot;&quot;REQ-API-001: Space CRUD&quot;&quot;&quot;
    ...
</code></pre>
<p>Details:</p>
<ul>
<li>Replace hyphens in <code>REQ-XXX-001</code> with underscores to form <code>req_xxx_001</code>.</li>
<li><code>feature</code> should reflect the domain under test (e.g., api, entry, sto, form).</li>
</ul>
<h3>Test Files</h3>
<pre><code>ugoite-cli/tests/
├── conftest.py          # Shared fixtures
├── test_space.py        # Space tests
├── test_entries.py      # Entry tests
├── test_indexer.py      # Indexer tests
└── ...

backend/tests/
├── conftest.py          # Shared fixtures
├── test_api.py          # API endpoint tests
├── test_api_memory.py   # Memory filesystem tests
└── ...

frontend/src/
├── lib/
│   ├── store.test.ts    # Store tests
│   └── client.test.ts   # API client tests
└── components/
    └── *.test.tsx       # Component tests
</code></pre>
<h2>Requirements Traceability</h2>
<p>Every test should map to a requirement:</p>
<pre><code class="language-python">def test_entry_create_basic():
    &quot;&quot;&quot;REQ-ENTRY-001: Entry Creation&quot;&quot;&quot;
    ...
</code></pre>
<p>Verification tests in <code>docs/tests/</code> ensure coverage.</p>
<h3>Requirement-aware Naming Convention</h3>
<p>Requirement traceability is enforced through the requirements YAML and REQ
references in tests. Python tests generally keep descriptive names and embed the
REQ ID in docstrings or comments:</p>
<pre><code class="language-python">def test_all_requirements_have_tests() -&gt; None:
    &quot;&quot;&quot;REQ-API-005: Requirements must list tests and files must exist.&quot;&quot;&quot;
    ...
</code></pre>
<p>Rust tests in <code>ugoite-core/tests/</code> use a requirement-aware naming convention:</p>
<pre><code class="language-rust">async fn test_entry_req_entry_001_create_entry_basic() -&gt; anyhow::Result&lt;()&gt; {
    // REQ-ENTRY-001
    ...
}
</code></pre>
<p>When using this pattern, replace hyphens in <code>REQ-XXX-001</code> with underscores to
form <code>req_xxx_001</code>. The <code>feature</code> segment should reflect the domain under test
(e.g., api, space, entry, form, core, cli).</p>
<h2>Mocking Strategy</h2>
<h3>Backend</h3>
<ul>
<li>Memory filesystem via fsspec <code>memory://</code> protocol</li>
<li>No external service mocks needed</li>
</ul>
<h3>Frontend</h3>
<ul>
<li>Mock API responses with vitest mocks</li>
<li>Component isolation with test utilities</li>
</ul>
<h3>E2E</h3>
<ul>
<li>Real servers, real HTTP</li>
<li>Test database reset between tests</li>
</ul>
 </article>  </main> </body></html>